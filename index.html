<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Personal Document Scanner</title>

<link
  href="https://unpkg.com/cropperjs/dist/cropper.css"
  rel="stylesheet"
/>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 15px;
  background: #f6f6f6;
}
h2 { text-align:center; }

button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 16px;
}

img {
  max-width: 100%;
  margin-top: 10px;
  display: none;
}
</style>
</head>

<body>

<h2>Document Scanner</h2>

<input type="file" accept="image/*" id="fileInput">

<img id="image">

<button id="cropBtn" style="display:none;">Potong Dokumen</button>
<button id="recropBtn" style="display:none;">Crop Ulang</button>

<script src="https://unpkg.com/cropperjs/dist/cropper.js"></script>

<script>
let cropper;
const image = document.getElementById("image");
const fileInput = document.getElementById("fileInput");
const cropBtn = document.getElementById("cropBtn");
const recropBtn = document.getElementById("recropBtn");

fileInput.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = () => {
    image.src = reader.result;
    image.style.display = "block";

    if (cropper) cropper.destroy();

    cropper = new Cropper(image, {
      viewMode: 1,
      autoCropArea: 0.9,
      movable: true,
      zoomable: true,
      scalable: true,
      rotatable: false
    });

    cropBtn.style.display = "block";
    recropBtn.style.display = "none";
  };
  reader.readAsDataURL(file);
});

cropBtn.onclick = () => {
  const canvas = cropper.getCroppedCanvas();
  image.src = canvas.toDataURL("image/jpeg", 0.9);

  cropper.destroy();
  cropper = null;

  cropBtn.style.display = "none";
  recropBtn.style.display = "block";
};

recropBtn.onclick = () => {
  cropper = new Cropper(image, {
    viewMode: 1,
    autoCropArea: 0.9
  });

  cropBtn.style.display = "block";
  recropBtn.style.display = "none";
};
</script>

</body>
</html>
